services:
  mysql:
      image: mysql:8.0
      container_name: mysql-container
      environment:
        MYSQL_ROOT_PASSWORD: ${DB_PASSWORD:-KuranGames!}
        MYSQL_DATABASE: ${DB_NAME:-card_games}
        MYSQL_USER: ${DB_USER:-root}
        MYSQL_PASSWORD: ${DB_PASSWORD:-KuranGames!}
      command: ["mysqld", "--default-authentication-plugin=mysql_native_password", "--character-set-server=utf8mb4", "--collation-server=utf8mb4_unicode_ci"]
      ports:
        - "3306:3306"
      volumes:
        - mysql_data:/var/lib/mysql

  minio:
      image: minio/minio:RELEASE.2022-01-04T07-41-07Z
      container_name: retainer_minio
      environment:
        MINIO_ROOT_USER: ${MINIO_ROOT_USER:-retainer_admin}
        MINIO_ROOT_PASSWORD: ${MINIO_ROOT_PASSWORD:-RetainerSecure2025!}
        # 公网访问地址（替换为你的服务器公网 IP 或域名）
        MINIO_BROWSER_REDIRECT_URL: ${MINIO_BROWSER_REDIRECT_URL:-http://localhost:9001}
        MINIO_SERVER_URL: ${MINIO_SERVER_URL:-http://localhost:9000}
      ports:
        - "9000:9000"
        - "9001:9001"
      volumes:
        - minio_data:/data
      command: server /data --console-address ":9001"

  redis:
      image: redis:7-alpine
      container_name: retainer_redis
      environment:
        REDIS_PASSWORD: ${REDIS_PASSWORD:-KuranGames!}
      ports:
        - "6379:6379"
      volumes:
        - redis_data:/data
      command: redis-server --requirepass ${REDIS_PASSWORD:-KuranGames!}
      restart: unless-stopped
      deploy:
        resources:
          limits:
            memory: 200M
          reservations:
            memory: 64M

volumes:
  mysql_data:
  minio_data:
  redis_data:


